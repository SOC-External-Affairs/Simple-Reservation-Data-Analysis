<div class="wrap">
    <h1>Bulk Upload Reservations</h1>
    
    <form method="post" action="{{ admin_url('admin-post.php') }}" enctype="multipart/form-data">
        <input type="hidden" name="action" value="upload_reservations">
        {{ wp_nonce_field('upload_reservations')|raw }}
        
        <table class="form-table">
            <tr>
                <th><label for="excel_file">Excel File</label></th>
                <td>
                    <input type="file" id="excel_file" name="excel_file" accept=".xlsx,.xls,.csv" required>
                    <p class="description">Upload an Excel file (.xlsx, .xls) or CSV file</p>
                </td>
            </tr>
            <tr>
                <th><label for="group_column">Group Name Column</label></th>
                <td>
                    <select id="group_column" name="group_column" class="regular-text" required>
                        <option value="">Select Column</option>
                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'|split('') %}
                        <option value="{{ letter }}">{{ letter }}</option>
                        {% endfor %}
                        <option value="AA">AA</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th><label for="date_column">Event Date Column</label></th>
                <td>
                    <select id="date_column" name="date_column" class="regular-text" required>
                        <option value="">Select Column</option>
                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'|split('') %}
                        <option value="{{ letter }}">{{ letter }}</option>
                        {% endfor %}
                        <option value="AA">AA</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th><label for="location_column">Location Column</label></th>
                <td>
                    <select id="location_column" name="location_column" class="regular-text" required>
                        <option value="">Select Column</option>
                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'|split('') %}
                        <option value="{{ letter }}">{{ letter }}</option>
                        {% endfor %}
                        <option value="AA">AA</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th><label for="duration_column">Duration (Hours) Column</label></th>
                <td>
                    <select id="duration_column" name="duration_column" class="regular-text" required>
                        <option value="">Select Column</option>
                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'|split('') %}
                        <option value="{{ letter }}">{{ letter }}</option>
                        {% endfor %}
                        <option value="AA">AA</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th><label for="when_inserted_column">When Inserted Column</label></th>
                <td>
                    <select id="when_inserted_column" name="when_inserted_column" class="regular-text" required>
                        <option value="">Select Column</option>
                        {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'|split('') %}
                        <option value="{{ letter }}">{{ letter }}</option>
                        {% endfor %}
                        <option value="AA">AA</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th><label for="start_row">Start Row</label></th>
                <td>
                    <input type="number" id="start_row" name="start_row" value="2" min="1" class="regular-text" required>
                    <p class="description">Row number to start reading data (usually 2 to skip headers)</p>
                </td>
            </tr>
        </table>
        
        <p class="submit">
            <input type="submit" class="button-primary" value="Upload and Process">
            <a href="{{ admin_url('admin.php?page=reservations') }}" class="button">Cancel</a>
        </p>
    </form>
</div>